/*!
* 	jQuery Magic Accordion
* 	https://github.com/lukesnowden/magic-accordion
* 	Copyright 2014 Luke Snowden
* 	Released under the MIT license:
* 	http://www.opensource.org/licenses/mit-license.php
*/
!function(i){i.fn.magicAccordion=function(a){var a=i.extend({openOnLoad:1,hashTrail:!1,headingTag:"h2",bodyClass:"body",headClass:"head",activeClass:"active",easing:"linear",speed:200},a),e=function(e){var n,t=i(e),s=!0,c=[],o=function(){var a=i.Event("created.magic");a.sections=c,a.accordion=n,t.trigger(a)},d=function(){c=[],n=i('<div class="magic-accordion"></div>'),i("> "+a.headingTag,t).each(function(){var e=i(this),n=[],t=!1;e.nextAll().each(function(){var e=i(this);t||e[0].tagName.toLowerCase()===a.headingTag?t=!0:n.push(e.clone())}),c.push({heading:e.clone(),content:n})})},r=function(){for(var e in c){var s=c[e].heading.addClass(a.headClass),d=i("<div></div>").addClass(a.bodyClass);s.appendTo(n);for(var r in c[e].content)c[e].content[r].appendTo(d);d.appendTo(n)}n.insertAfter(t),i("."+a.bodyClass,n).slideUp(0),i("*",t).each(function(){void 0!==i(this).attr("id")&&(i(this).attr("id").match(/^magic_/)||i(this).attr("id","magic_"+i(this).attr("id")))}),t.hide(),o()},h=function(){i("."+a.headClass,n).unbind("click.magic").bind("click.magic",function(e){if(a.hashTrail){s=!1;var c=i(this).index();window.location.hash="slide-"+(0==c?1:c/2+1)}e.preventDefault();var o=i(this),d=function(){var a=i.Event("closed.magic");a.head=i(this).prev(),a.body=i(this),a.index=Math.floor(i(this).index()/2),t.trigger(a)},r=function(){var a=i.Event("opened.magic");a.head=o,a.body=i(this),a.index=Math.floor(i(this).index()/2),t.trigger(a)};i("."+a.headClass+"."+a.activeClass,n).removeClass(a.activeClass),o.addClass(a.activeClass);var h=i("."+a.bodyClass+":visible",n),l=o.next();h.get(0)!==l.get(0)?(l.slideDown({complete:r,duration:a.speed,easing:a.easing}),h.slideUp({complete:d,duration:a.speed,easing:a.easing})):(i("."+a.headClass+"."+a.activeClass,n).removeClass(a.activeClass),h.slideUp({complete:d,duration:a.speed,easing:a.easing})),setTimeout(function(){s=!0},100)}),a.openOnLoad&&l()===!1&&i("."+a.headClass,n).eq(a.openOnLoad-1).trigger("click.magic")},l=function(){var i=window.location.hash;return i.match(/^#slide-[0-9]\d*/)?Number(i.replace("#slide-","")):!1},g=function(){if(a.hashTrail&&s){var e=l();e&&i("."+a.headClass,n).eq(e-1).trigger("click.magic")}},v=function(){if(s){var e=l();e&&i("."+a.headClass,n).eq(e-1).trigger("click.magic")}},u=function(){i(window).bind("hashchange",v)};this.unbind=function(){t.is(":visible")||(n.remove(),t.show(),i("*",t).each(function(){void 0!==i(this).attr("id")&&i(this).attr("id",i(this).attr("id").replace(/^magic_/,""))}))},this.rebind=function(){t.is(":visible")&&(d(),r(),h())},this.object=function(){return{accordion:n,sections:c}},d(),r(),h(),g(),u(),t.data("magic-accordion",this)};return i(this).each(function(i){new e(this,i)})}}(jQuery);